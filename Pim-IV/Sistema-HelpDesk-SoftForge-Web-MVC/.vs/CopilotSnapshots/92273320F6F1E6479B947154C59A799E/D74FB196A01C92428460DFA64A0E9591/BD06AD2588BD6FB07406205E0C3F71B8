@page
@addTagHelper *, Microsoft.AspNetCore.Mvc.TagHelpers
<partial name="~/Pages/Shared/_DbTestesNav.cshtml" />
<div class="db-page container-fluid">
    <div class="db-header">
        <header>
            <h1>Escalonamento</h1>
            <p>Área de monitoramento e escalonamento de chamados</p>
        </header>
    </div>

    <div class="db-nav">
        <nav>
            <a asp-page="/DbTestes/InicialPainel">Início</a> |
            <a asp-page="/DbTestes/Escalonamento">Escalonamento</a> |
            <a asp-page="/DbTestes/Relatorios">Relatórios</a>
        </nav>
    </div>

    <div class="db-content">
        <main>
            <section class="db-section">
                <h2>?? Escalonamento de Chamados</h2>
                <p><strong>Coordenador:</strong> [Nome do Coordenador]</p>
                <p><strong>Equipe:</strong> [TI / Todas]</p>
            </section>

            <section class="db-section">
                <h3>?? Alertas Prioritários</h3>
                <ul>
                    <li><strong>[CRÍTICO]</strong>2 chamados críticos sem resposta há mais de10 minutos</li>
                    <li><strong>[ALERTA]</strong>5 chamados com SLA acima de75% consumido</li>
                    <li><strong>[ATENÇÃO]</strong>3 chamados com SLA acima de50% consumido</li>
                    <li><strong>[INFO]</strong> Técnico Carlos Oliveira com14/15 chamados ativos</li>
                </ul>
            </section>

            <section class="db-section">
                <h3>?? Filtros e Pesquisa</h3>
                <form method="get" asp-page="/DbTestes/Escalonamento">
                    <label for="filtro_urgencia">Urgência:</label>
                    <select id="filtro_urgencia" name="urgencia">
                        <option value="">Todas</option>
                        <option value="critico">Críticos sem resposta</option>
                        <option value="sla_75">SLA &gt;75%</option>
                        <option value="sla_50">SLA50-75%</option>
                    </select>

                    <label for="filtro_tecnico">Técnico:</label>
                    <select id="filtro_tecnico" name="tecnico">
                        <option value="">Todos</option>
                        <option value="maria">Maria Souza</option>
                        <option value="carlos">Carlos Oliveira</option>
                        <option value="ana">Ana Lima</option>
                        <option value="joao">João Ferreira</option>
                        <option value="paula">Paula Martins</option>
                    </select>

                    <label for="busca_protocolo">Buscar por protocolo:</label>
                    <input type="text" id="busca_protocolo" name="protocolo" placeholder="Ex: CHAM-2025-001" />

                    <button type="submit" class="btn btn-primary">Filtrar</button>
                </form>
            </section>

            <section class="db-section">
                <h3>?? Chamados Críticos sem Primeira Resposta (&gt;10 minutos)</h3>
                <p>Chamados críticos que não tiveram resposta inicial no prazo de 10 minutos</p>
                <p><em>Total: 2 chamados</em></p>

                <table class="table table-bordered">
                    <thead>
                        <tr>
                            <th>Protocolo</th>
                            <th>Título</th>
                            <th>Solicitante</th>
                            <th>Categoria</th>
                            <th>Tempo sem Resposta</th>
                            <th>Técnico Atual</th>
                            <th>Ações</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><strong>#CHAM-2025-067</strong></td>
                            <td>Sistema de produção travado</td>
                            <td>João Silva</td>
                            <td>Software</td>
                            <td><strong>15 minutos</strong></td>
                            <td>Maria Souza (N1)</td>
                            <td><a asp-page="/DbTestes/DetalhesEscalonamento" asp-route-id="067">Ver Detalhes</a>
                            </td>
                        </tr>
                        <tr>
                            <td><strong>#CHAM-2025-070</strong></td>
                            <td>Rede completa fora do ar</td>
                            <td>Pedro Santos</td>
                            <td>Rede</td>
                            <td><strong>12 minutos</strong></td>
                            <td>Não Atribuído</td>
                            <td><a asp-page="/DbTestes/DetalhesEscalonamento" asp-route-id="070">Ver Detalhes</a>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </section>

            <section class="db-section">
                <h3>?? Chamados em Risco Alto (&gt;75%)</h3>
                <p>Chamados próximos a violar o SLA de resolução</p>
                <p><em>Total: 3 chamados em risco alto</em></p>

                <table class="table table-bordered">
                    <thead>
                        <tr>
                            <th>Protocolo</th>
                            <th>Título</th>
                            <th>Prioridade</th>
                            <th>Técnico</th>
                            <th>SLA Consumido</th>
                            <th>Tempo Restante</th>
                            <th>Ações</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><strong>#CHAM-2025-045</strong></td>
                            <td>Impressora não funciona</td>
                            <td>ALTA</td>
                            <td>Carlos Oliveira (N2)</td>
                            <td><strong>85%</strong></td>
                            <td>1h10min</td>
                            <td><a asp-page="/DbTestes/DetalhesEscalonamento" asp-route-id="045">Ver Detalhes</a>
                            </td>
                        </tr>
                        <tr>
                            <td><strong>#CHAM-2025-051</strong></td>
                            <td>Erro no sistema financeiro</td>
                            <td>CRÍTICA</td>
                            <td>Maria Souza (N1)</td>
                            <td><strong>80%</strong></td>
                            <td>48 minutos</td>
                            <td><a asp-page="/DbTestes/DetalhesEscalonamento" asp-route-id="051">Ver Detalhes</a>
                            </td>
                        </tr>
                        <tr>
                            <td><strong>#CHAM-2025-058</strong></td>
                            <td>Backup falhou</td>
                            <td>ALTA</td>
                            <td>João Ferreira (N2)</td>
                            <td><strong>78%</strong></td>
                            <td>1h45min</td>
                            <td><a asp-page="/DbTestes/DetalhesEscalonamento" asp-route-id="058">Ver Detalhes</a>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </section>

            <section class="db-section">
                <h3>?? Chamados em Atenção (SLA 50-75%)</h3>
                <p>Chamados que consumiram metade ou mais do tempo de SLA</p>
                <p><em>Total: 2 chamados em atenção</em></p>

                <table class="table table-bordered">
                    <thead>
                        <tr>
                            <th>Protocolo</th>
                            <th>Título</th>
                            <th>Prioridade</th>
                            <th>Técnico</th>
                            <th>SLA Consumido</th>
                            <th>Tempo Restante</th>
                            <th>Ações</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><strong>#CHAM-2025-033</strong></td>
                            <td>Reset de senha</td>
                            <td>MÉDIA</td>
                            <td>Ana Lima (N1)</td>
                            <td>65%</td>
                            <td>8h20min</td>
                            <td><a asp-page="/DbTestes/DetalhesEscalonamento" asp-route-id="033">Ver Detalhes</a>
                            </td>
                        </tr>
                        <tr>
                            <td><strong>#CHAM-2025-038</strong></td>
                            <td>Instalação de software</td>
                            <td>MÉDIA</td>
                            <td>Carlos Oliveira (N2)</td>
                            <td>58%</td>
                            <td>10h05min</td>
                            <td><a asp-page="/DbTestes/DetalhesEscalonamento" asp-route-id="038">Ver Detalhes</a>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </section>

            <section class="db-section">
                <h3>?? Status da Equipe Técnica</h3>
                <table class="table table-bordered">
                    <thead>
                        <tr>
                            <th>Técnico</th>
                            <th>Nível</th>
                            <th>Especialidade</th>
                            <th>Chamados Ativos</th>
                            <th>Chamados Críticos</th>
                            <th>Status</th>
                            <th>Ações</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>Maria Souza</td>
                            <td>N1</td>
                            <td>Geral</td>
                            <td>8/15</td>
                            <td>1/3</td>
                            <td>Disponível</td>
                            <td><a asp-page="/DbTestes/MeusChamados">Ver Chamados</a></td>
                        </tr>
                        <tr>
                            <td>Carlos Oliveira</td>
                            <td>N2</td>
                            <td>Rede</td>
                            <td>14/15</td>
                            <td>2/3</td>
                            <td><strong>Quase Cheio</strong></td>
                            <td><a asp-page="/DbTestes/MeusChamados">Ver Chamados</a></td>
                        </tr>
                    </tbody>
                </table>
            </section>

            <section class="db-section">
                <h3>??? Escalonamento Manual</h3>
                <form method="post" asp-page="/DbTestes/Escalonamento">
                    <label for="protocolo_escalonar">Protocolo do Chamado:</label><br />
                    <input type="text" id="protocolo_escalonar" name="protocolo" placeholder="Ex: CHAM-2025-001" required
                        class="form-control" /><br /><br />

                    <label for="motivo_escalonamento">Motivo do Escalonamento:</label><br />
                    <textarea id="motivo_escalonamento" name="motivo" rows="4" cols="80"
                        placeholder="Justifique o motivo do escalonamento..." required class="form-control"></textarea><br /><br />

                    <label for="novo_tecnico">Atribuir para:</label><br />
                    <select id="novo_tecnico" name="novo_tecnico" required class="form-select">
                        <option value="">Selecione um técnico...</option>
                        <option value="maria">Maria Souza (N1 -8/15 chamados)</option>
                        <option value="carlos">Carlos Oliveira (N2 -14/15 chamados)</option>
                        <option value="ana">Ana Lima (N1 -5/15 chamados)</option>
                        <option value="joao">João Ferreira (N2 -10/15 chamados)</option>
                        <option value="paula">Paula Martins (N3 -6/15 chamados)</option>
                    </select><br /><br />

                    <label for="nova_prioridade">Reclassificar Prioridade (opcional):</label><br />
                    <select id="nova_prioridade" name="nova_prioridade" class="form-select">
                        <option value="">Manter prioridade atual</option>
                        <option value="critica">Crítica</option>
                        <option value="alta">Alta</option>
                        <option value="media">Média</option>
                        <option value="baixa">Baixa</option>
                    </select><br /><br />

                    <button type="submit" class="btn btn-primary">Realizar Escalonamento</button>
                </form>
            </section>
        </main>
    </div>

    <div class="db-footer">
        <footer>
            <p>©2025 SoftForge - Todos os direitos reservados</p>
        </footer>
    </div>
</div>