@model PIM_FINAL.Models.AbrirChamado
@{
    ViewData["Title"] = "Abrir Chamado - Teste";
}

@addTagHelper *, Microsoft.AspNetCore.Mvc.TagHelpers
<link rel="stylesheet" href="/css/dbtestes.css" />

<div class="db-page container-fluid">
    @await Html.PartialAsync("_HeaderNav")

    <main class="db-content">
        <section class="db-section db-overview">
            <h2> Abrir Novo Chamado</h2>
            <p><strong>Solicitante:</strong> @(Model?.SolicitanteNome ?? "(não informado)")</p>
            <p><strong>Departamento:</strong> @(Model?.SolicitanteDepartamento ?? "(não informado)")</p>
        </section>

        <section class="db-section db-form">
            <h3>Preencha as informações do chamado</h3>
            <form method="post" asp-controller="Site" asp-action="AbrirChamado" enctype="multipart/form-data">
                <div class="mb-3">
                    <label for="titulo">Título do Problema:</label><br />
                    <input
                        type="text"
                        id="titulo"
                        name="Titulo"
                        size="80"
                        placeholder="Ex: Impressora não está funcionando"
                        required
                        class="form-control"
                        value="@(Model?.Titulo ?? String.Empty)"
                    />
                </div>

                <div class="mb-3">
                    <label for="descricao">Descrição Detalhada:</label><br />
                    <textarea
                        id="descricao"
                        name="Descricao"
                        rows="8"
                        cols="80"
                        placeholder="Descreva o problema com o máximo de detalhes possível..."
                        required
                        class="form-control"
                    >@(Model?.Descricao ?? String.Empty)</textarea>
                </div>

                <div class="mb-3">
                    <label for="categoria">Categoria:</label><br />
                    <select id="categoria" name="CategoriaId" class="form-select" required>
                        <option value="0">Automático</option>
                        @foreach(var it in Model?.CategoriasSelect ?? new List<Microsoft.AspNetCore.Mvc.Rendering.SelectListItem>())
                        {
                        <option value="@it.Value">@it.Text</option>
                        }
                    </select>
                    <p><em> Se "Automático" for selecionado, a IA sugerirá a categoria ao enviar.</em></p>
                </div>

                <div class="mb-3">
                    <label for="prioridade">Prioridade:</label><br />
                    <select id="prioridade" name="PrioridadeId" class="form-select">
                        <option value="0">Automático</option>
                        @foreach(var it in Model?.PrioridadesSelect ?? new List<Microsoft.AspNetCore.Mvc.Rendering.SelectListItem>())
                        {
                        <option value="@it.Value">@it.Text</option>
                        }
                    </select>
                    <p><em> Se "Automático" for selecionado, a IA sugerirá a prioridade ao enviar.</em></p>
                </div>

                <div class="mb-3">
                    <label for="anexo">Anexar Arquivo (Opcional):</label><br />
                    <input type="file" id="anexo" name="AnexoFile" class="form-control" />
                    <p><em>Formatos aceitos: imagens, PDF, documentos (máx.5MB)</em></p>
                </div>

                <div class="db-actions mb-3">
                    <button type="submit" class="btn btn-primary">Abrir Chamado</button>
                    <button type="reset" class="btn btn-secondary">Limpar Formulário</button>
                </div>
            </form>
        </section>

        @if (Model?.Created == true)
        {
        <section class="db-section db-created mt-4">
            <h3>Chamado criado</h3>
            <p>Protocolo: <strong>@(Model?.CreatedProtocol ?? "(não disponível)")</strong></p>
        </section>
        }

        <section class="db-section db-info">
            <h3>Informações Importantes</h3>
            <ul>
                <li>Após abrir o chamado, você receberá um <strong>número de protocolo</strong></li>
                <li>Você será notificado por e-mail sobre atualizações do chamado</li>
                <li>Você pode acompanhar o status em <a asp-controller="Site" asp-action="MeusChamados">Meus Chamados</a></li>
                <li>O tempo de atendimento depende da prioridade do chamado</li>
            </ul>
        </section>

        <section class="db-section db-sla">
            <h4>Tempo de Atendimento (SLA):</h4>
            <table class="table table-bordered stack-mobile">
                <thead>
                    <tr>
                        <th>Prioridade</th>
                        <th>Primeira Resposta</th>
                        <th>Resolução</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td data-label="Prioridade"><strong>Crítica</strong></td>
                        <td data-label="Primeira Resposta">1 hora</td>
                        <td data-label="Resolução">4 horas</td>
                    </tr>
                    <tr>
                        <td data-label="Prioridade"><strong>Alta</strong></td>
                        <td data-label="Primeira Resposta">2 horas</td>
                        <td data-label="Resolução">8 horas</td>
                    </tr>
                    <tr>
                        <td data-label="Prioridade">Média</td>
                        <td data-label="Primeira Resposta">4 horas</td>
                        <td data-label="Resolução">24 horas</td>
                    </tr>
                    <tr>
                        <td data-label="Prioridade">Baixa</td>
                        <td data-label="Primeira Resposta">8 horas</td>
                        <td data-label="Resolução">72 horas</td>
                    </tr>
                </tbody>
            </table>
        </section>
    </main>

    <div class="db-footer">
        <footer>
            <p>©2025 SoftForge - Todos os direitos reservados</p>
        </footer>
    </div>
</div>