using Microsoft.AspNetCore.Mvc;
using PIM_FINAL.Models;
using System.Collections.Generic;
using System.Linq;

namespace PIM_FINAL.Controllers
{
 public class DepartamentoController : Controller
 {
 // Repositório em memória para demonstração
 private static readonly List<Departamento> _departamentos = new List<Departamento>();

 public IActionResult Index()
 {
 return View(_departamentos);
 }

 public IActionResult Details(int id)
 {
 var departamento = _departamentos.FirstOrDefault(d => d.DepartamentoId == id);
 if (departamento == null) return NotFound();
 return View(departamento);
 }

 public IActionResult Create()
 {
 return View();
 }

 [HttpPost]
 public IActionResult Create(Departamento model)
 {
 if (!ModelState.IsValid) return View(model);
 model.DepartamentoId = _departamentos.Count >0 ? _departamentos.Max(d => d.DepartamentoId) +1 :1;
 _departamentos.Add(model);
 return RedirectToAction(nameof(Index));
 }

 public IActionResult Edit(int id)
 {
 var departamento = _departamentos.FirstOrDefault(d => d.DepartamentoId == id);
 if (departamento == null) return NotFound();
 return View(departamento);
 }

 [HttpPost]
 public IActionResult Edit(Departamento model)
 {
 if (!ModelState.IsValid) return View(model);
 var departamento = _departamentos.FirstOrDefault(d => d.DepartamentoId == model.DepartamentoId);
 if (departamento == null) return NotFound();
 departamento.NomeDepartamento = model.NomeDepartamento;
 departamento.Descricao = model.Descricao;
 return RedirectToAction(nameof(Index));
 }

 public IActionResult Delete(int id)
 {
 var departamento = _departamentos.FirstOrDefault(d => d.DepartamentoId == id);
 if (departamento == null) return NotFound();
 return View(departamento);
 }

 [HttpPost, ActionName("Delete")]
 public IActionResult DeleteConfirmed(int id)
 {
 var departamento = _departamentos.FirstOrDefault(d => d.DepartamentoId == id);
 if (departamento == null) return NotFound();
 _departamentos.Remove(departamento);
 return RedirectToAction(nameof(Index));
 }
 }
}
