// Opt-in list/table limiter. Apply only to elements with class 'limit-rows' or a 'data-limit' attribute.
(function(){
 const DEFAULT_LIMIT =3;
 function getLimit(el){
 const v = parseInt(el.getAttribute('data-limit') || '',10);
 return Number.isFinite(v) && v >0 ? v : DEFAULT_LIMIT;
 }
 function makeButton(){
 const btn = document.createElement('button');
 btn.type = 'button';
 btn.className = 'btn btn-sm btn-secondary limit-toggle';
 btn.textContent = 'Mostrar mais';
 return btn;
 }
 function applyToList(list){
 const LIMIT = getLimit(list);
 const items = Array.from(list.children);
 if(items.length <= LIMIT) return;
 const hidden = items.slice(LIMIT);
 hidden.forEach(li => li.style.display = 'none');
 const btn = makeButton();
 btn.addEventListener('click', () => {
 const expanded = hidden[0].style.display !== 'none';
 hidden.forEach(li => li.style.display = expanded ? 'none' : 'list-item');
 btn.textContent = expanded ? 'Mostrar mais' : 'Mostrar menos';
 });
 const wrap = document.createElement('div');
 wrap.className = 'limit-wrap';
 wrap.appendChild(btn);
 list.parentNode.insertBefore(wrap, list.nextSibling);
 }
 function applyToTable(table){
 const LIMIT = getLimit(table);
 const tb = table.querySelector('tbody') || table;
 const rows = Array.from(tb.querySelectorAll('tr'));
 if(rows.length <= LIMIT) return;
 const hidden = rows.slice(LIMIT);
 hidden.forEach(r => r.style.display = 'none');
 const btn = makeButton();
 btn.addEventListener('click', () => {
 const expanded = hidden[0].style.display !== 'none';
 hidden.forEach(r => r.style.display = expanded ? 'none' : 'table-row');
 btn.textContent = expanded ? 'Mostrar mais' : 'Mostrar menos';
 });
 const wrap = document.createElement('div');
 wrap.className = 'limit-wrap';
 wrap.style.marginTop = '4px';
 wrap.appendChild(btn);
 // Place after the table to avoid breaking layout
 table.insertAdjacentElement('afterend', wrap);
 }
 document.addEventListener('DOMContentLoaded', () => {
 document.querySelectorAll('ul.limit-rows, ol.limit-rows, ul[data-limit], ol[data-limit]').forEach(applyToList);
 document.querySelectorAll('table.limit-rows, table[data-limit]').forEach(applyToTable);
 });
})();